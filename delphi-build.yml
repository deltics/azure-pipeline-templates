parameters:
  delphiVersion: ''
  project: ''
  appType: 'CONSOLE'    # CONSOLE (default) or GUI
  platform: ''
  searchPath: ''
  unitScopes: 'System;System.Win;Vcl;WinApi'
  fixPack: 'true'
  verbose: 'false'
  preBuild: []
  preBuildInline: []
  postBuild: []
  postBuildInline: []

steps:
- ${{ parameters.preBuild }}
- powershell: |
    . scripts\DelphiBuild.ps1

    $delphiVersion = '${{ parameters.delphiVersion }}'
    $project       = '${{ parameters.project }}'
    $appType       = '${{ parameters.appType }}'
    $platform      = '${{ parameters.platform }}'
    $searchPath    = '${{ parameters.searchPath }}'
    $unitScopes    = '${{ parameters.unitScopes }}'
    $fixPack       = '${{ parameters.fixPack }}'
    $verbose       = '${{ parameters.verbose }}'
    $preDcc        = '${{ parameters.preBuildInline }}'
    $postDcc       = '${{ parameters.postBuildInline }}'

    DelphiBuild($delphiVersion,
                $project,
                $appType,
                $platform,
                $searchPath,
                $unitScopes,
                $fixPack,
                $verbose,
                $preDcc,
                $postDcc)

displayName: 'Delphi Build (${{ parameters.delphiVersion }}) of ${{ parameters.project }}'
- ${{ parameters.postBuild }}
